# Shared household — общий дом, продукты и бытовая химия

## Зачем

Сейчас HiDL мыслит «пользователь → его дом → его продукты».  
Но в реальности часто:

- живёт пара/семья;
- оба пользуются HiDL;
- еда и бытовая химия у них общие.

Хотим:

- общие продукты на кухне;
- общий учёт бытовых средств;
- предупреждения о сроках годности и расходниках — для всех, кто живёт в этом доме.

## 1. Домохозяйство (household)

### 1.1. Модель

```text
households
- id
- name
- created_by
- created_at

household_members
- id
- household_id
- user_id
- role (owner/member)
- joined_at
- is_active
Пользователь может:

жить один → household 1:1;

пригласить другого → они разделяют дом.

1.2. UX
В настройках / в разделе «Дом»:

«Живёшь один(а) или с кем-то?»

Кнопки:

«Я живу один(а)» — ничего не делаем;

«Мы живём вместе и оба пользуемся HiDL»:

«Создать дом и пригласить» → создаём household, даём код-приглашение;

«У меня есть код от партнёра» → вступаем в существующий household.

2. Общие продукты (pantry)
Текущая идея pantry_items:

text
Копировать код
pantry_items: id, user_id, name, amount, unit, expires_at, category
Для общего дома:

text
Копировать код
household_pantry_items
- id
- household_id
- name
- amount
- unit
- expires_at (DATE, nullable)
- category
- updated_by
- updated_at
Все участники household видят один и тот же список продуктов.

Когда кто-то готовит рецепт и отмечает «готово»:

списываем продукты из household_pantry_items;

остатки и сроки видны всем.

Сроки годности:

раз в день/два формируем список продуктов с expires_at в ближайшие 3–5 дней;

в /today показываем:

«Продукты: у 2 вещей скоро истекает срок — …»

кнопка «Посмотреть» и опционально «Придумать, что с этим приготовить».

3. Бытовая химия и расходники
Отдельный склад под уборку:

text
Копировать код
household_supplies
- id
- household_id
- name (моющее для посуды, средство для унитаза, мусорные пакеты, губки и т.п.)
- category (cleaning, trash_bags, paper, laundry, other)
- amount
- unit (упаковок, штук)
- low_threshold
- updated_by
- updated_at
3.1. Связь с уборкой
В сценариях из Дом/Уборка:

шаг «Почистить унитаз» → consume_supply("средство для унитаза", 1);

шаг «Помыть полы» → consume_supply("средство для пола", 1);

шаг «Вынести мусор» → можно списывать мусорные пакеты.

Если amount <= low_threshold:

в /today строка:

«Бытовое: заканчиваются мусорные пакеты и средство для пола.»

кнопка Добавить в список покупок.

3.2. UX для списка
Раздел «Бытовое/Расходники»:

показать текущий список household_supplies;

кнопки:

«Добавить средство»;

«Изменить количество»;

«Удалить/скрыть».

4. Что с этим делать дальше (в спринтах)
В спринт 4 это не пихаем — слишком жирная фича.

Кандидат на спринт 5+:

ввести household и shared pantry;

потом добавить household_supplies;

потом уже завязывать это на рецепты и уборку.

yaml
Копировать код

---