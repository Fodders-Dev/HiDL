# Натуральные команды (NL) — черновик

## Цель
Описать базовые паттерны “человеческих” фраз, которые бот должен понимать одинаково для текста и (в будущем) голосовых. Парсер должен уметь извлекать действие и аргументы.

## Типы команд и примеры

### 1) Траты (expense)
- “потратил 700 вкусвилл еда”
- “+450 такси”
- “минус 1200 аренда”
- “запиши 300 кофе”

Извлекаем: сумма, категория/ярлык (по слову), знак (расход). Сумму — float, категория — слово после суммы или последнее слово.

### 2) Напоминания (reminder)
- “напомни завтра в 12:00 помыть полы”
- “через 2 часа позвонить маме”
- “напомни в 19:30 таблетки”
- “каждый вторник в 08:00 вода”

Извлекаем: текст, дата/время (абсолют или относительное), периодичность (если есть “каждый …”).

### 3) Уборка/дом (home)
- “что по дому сделать сегодня?”
- “уборка сейчас”
- “план на неделю”
- “перенеси полы на завтра”

Извлекаем: тип запроса (показать план/начать уборку/отложить дело). Если есть “перенеси/отложи +N дней” — target=N.

### 4) Вопросы к маме (ask_mom)
- “как стирать черные джинсы”
- “воняет из раковины, что делать”
- “что купить в первую неделю после переезда”
- “мало сил, с чего начать уборку”

Извлекаем: категория по ключевым словам (стирка/запах/переезд/кухня/уборка/здоровье) и текст вопроса.

## Позиция в коде
- Плановый модуль: `utils/nl_parser.py`
  - dataclass `ParsedCommand` (type: expense/reminder/home/ask, payload: dict).
  - Простые функции-паттерны: parse_expense(text), parse_reminder(text), parse_home(text), parse_mom(text).
- Использование:
  - Раздел Деньги: попытка распарсить текст как expense.
  - Напоминания: распарсить reminder и прокинуть в диалог.
  - Дом: при фразах “что по дому”/“уборка сейчас”.
  - /ask_mom: если текст не команда — искать карточку по тегам.

## Простейший формат ответа парсера (пример)
```
ParsedCommand(
  type="expense",
  payload={
    "amount": 700.0,
    "category": "вкусвилл",
    "raw_category": "еда"
  }
)
```

## Ограничения
- Ошибки — мягкие: если не поняли, вернуть None и дать подсказку “можешь написать так: …”.
- Числа искать по первому найденному token, время — HH:MM или фразы “через N часов/минут”, даты — “завтра/послезавтра/сегодня”.
